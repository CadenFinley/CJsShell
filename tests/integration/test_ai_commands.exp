#!/usr/bin/expect -f

# Test AI commands

set timeout 10
set terminal_bin [lindex $argv 0]

# Start the terminal application
spawn $terminal_bin
expect "DevToolsTerminal*"

# Test AI help
send "!ai help\r"
expect {
  "AI settings commands:" {
    puts "AI help command works"
  }
  timeout {
    puts "ERROR: AI help command timed out"
    exit 1
  }
}

# Test getting API key (should be empty or masked in CI)
send "!ai apikey get\r"
expect {
  "*" {
    puts "AI API key command works"
  }
  timeout {
    puts "ERROR: AI API key command timed out"
    exit 1
  }
}

# Test getting AI model
send "!ai model\r"
expect {
  "The current model is*" {
    puts "AI model command works"
  }
  timeout {
    puts "ERROR: AI model command timed out"
    exit 1
  }
}

# Exit the application
send "exit\r"
expect eof

exit 0
